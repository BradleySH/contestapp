{"version":3,"sources":["../../../src/commands/eject/installNodeDependenciesAsync.ts"],"names":["installNodeDependenciesAsync","projectRoot","packageManager","clean","cleanJsDepsStep","fs","remove","succeed","installJsDepsStep","CreateApp","message","chalk","bold","fail","red","SilentError"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AACO,eAAeA,4BAAf,CACLC,WADK,EAELC,cAFK,EAGL;AAAEC,EAAAA,KAAK,GAAG;AAAV,CAHK,EAIL;AACA,MAAIA,KAAJ,EAAW;AACT;AACA;AACA,UAAMC,eAAe,GAAG,0BAAc,mCAAd,CAAxB,CAHS,CAIT;AACA;;AACA,UAAMC,mBAAGC,MAAH,CAAU,cAAV,CAAN;AACAF,IAAAA,eAAe,CAACG,OAAhB,CAAwB,kCAAxB;AACD;;AAED,QAAMC,iBAAiB,GAAG,0BAAc,qCAAd,CAA1B;;AAEA,MAAI;AACF,UAAMC,SAAS,GAACT,4BAAV,CAAuCC,WAAvC,EAAoDC,cAApD,CAAN;AACAM,IAAAA,iBAAiB,CAACD,OAAlB,CAA0B,oCAA1B;AACD,GAHD,CAGE,MAAM;AACN,UAAMG,OAAO,GAAI,uEAAsER,cAAe,mBAAkBS,iBAAMC,IAAN,CACrH,GAAEV,cAAe,UADoG,CAEtH,kBAFF;AAGAM,IAAAA,iBAAiB,CAACK,IAAlB,CAAuBF,iBAAMG,GAAN,CAAUJ,OAAV,CAAvB,EAJM,CAKN;;AACA,UAAM,KAAIK,2BAAJ,EAAgBL,OAAhB,CAAN;AACD;AACF","sourcesContent":["import chalk from 'chalk';\nimport fs from 'fs-extra';\n\nimport { SilentError } from '../../CommandError';\nimport { logNewSection } from '../../utils/ora';\nimport * as CreateApp from '../utils/CreateApp';\n\n/**\n * Wraps PackageManager to install node modules and adds CLI logs.\n *\n * @param projectRoot\n */\nexport async function installNodeDependenciesAsync(\n  projectRoot: string,\n  packageManager: 'yarn' | 'npm',\n  { clean = true }: { clean: boolean }\n) {\n  if (clean) {\n    // This step can take a couple seconds, if the installation logs are enabled (with EXPO_DEBUG) then it\n    // ends up looking odd to see \"Installing JavaScript dependencies\" for ~5 seconds before the logs start showing up.\n    const cleanJsDepsStep = logNewSection('Cleaning JavaScript dependencies.');\n    // nuke the node modules\n    // TODO: this is substantially slower, we should find a better alternative to ensuring the modules are installed.\n    await fs.remove('node_modules');\n    cleanJsDepsStep.succeed('Cleaned JavaScript dependencies.');\n  }\n\n  const installJsDepsStep = logNewSection('Installing JavaScript dependencies.');\n\n  try {\n    await CreateApp.installNodeDependenciesAsync(projectRoot, packageManager);\n    installJsDepsStep.succeed('Installed JavaScript dependencies.');\n  } catch {\n    const message = `Something went wrong installing JavaScript dependencies, check your ${packageManager} logfile or run ${chalk.bold(\n      `${packageManager} install`\n    )} again manually.`;\n    installJsDepsStep.fail(chalk.red(message));\n    // TODO: actually show the error message from the package manager! :O\n    throw new SilentError(message);\n  }\n}\n"],"file":"installNodeDependenciesAsync.js"}