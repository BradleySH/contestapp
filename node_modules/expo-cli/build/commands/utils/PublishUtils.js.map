{"version":3,"sources":["../../../src/commands/utils/PublishUtils.ts"],"names":["VERSION","getPublishHistoryAsync","projectDir","options","count","isNaN","Error","user","UserManager","ensureLoggedInAsync","exp","skipSDKVersionRequirement","result","process","env","EXPO_LEGACY_API","formData","FormData","append","owner","Project","getSlugAsync","releaseChannel","platform","sdkVersion","Api","callMethodAsync","api","ApiV2","clientForUser","postAsync","slug","version","setPublishToChannelAsync","publishId","_rollbackPublicationFromChannelForPlatformAsync","historyQueryResult","history","queryResult","length","secondMostRecent","nonInteractiveOptions","parent","_printAndConfirm","publicationId","revertProgress","start","succeed","rollbackPublicationFromChannelAsync","restOfTheOptions","platforms","completedPlatforms","push","e","log","error","filter","includes","channel","partialOptions","detailOptions","detail","getPublicationDetailAsync","printPublicationDetailAsync","nonInteractive","confirm","type","name","message","raw","console","JSON","stringify","manifest","generalTableString","table","printTableJson","manifestTableString"],"mappings":"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","sourcesContent":["import { getConfig } from '@expo/config';\nimport { Api, ApiV2, FormData, Project, UserManager } from '@expo/xdl';\nimport ora from 'ora';\nimport * as table from './cli-table';\nimport log from '../../log';\nimport prompt from '../../prompt';\n\nexport type HistoryOptions = {\n  releaseChannel?: string;\n  count?: number;\n  platform?: 'android' | 'ios';\n  raw?: boolean;\n  sdkVersion?: string;\n};\n\nexport type DetailOptions = {\n  publishId?: string;\n  raw?: boolean;\n};\n\nexport type SetOptions = { releaseChannel: string; publishId: string };\n\nexport type RollbackOptions = {\n  releaseChannel: string;\n  sdkVersion: string;\n  platform?: 'android' | 'ios';\n  parent?: { nonInteractive?: boolean };\n};\n\nexport type Publication = {\n  fullName: string;\n  channel: string;\n  channelId: string;\n  publicationId: string;\n  appVersion: string;\n  sdkVersion: string;\n  publishedTime: string;\n  platform: 'android' | 'ios';\n};\n\nexport type PublicationDetail = {\n  manifest: {\n    [key: string]: string;\n  };\n  publishedTime: string;\n  publishingUsername: string;\n  packageUsername: string;\n  packageName: string;\n  fullName: string;\n  hash: string;\n  sdkVersion: string;\n  s3Key: string;\n  s3Url: string;\n  abiVersion: string | null;\n  bundleUrl: string | null;\n  platform: string;\n  version: string;\n  revisionId: string;\n  channels: { [key: string]: string }[];\n  publicationId: string;\n};\n\nconst VERSION = 2;\n\nexport async function getPublishHistoryAsync(\n  projectDir: string,\n  options: HistoryOptions\n): Promise<any> {\n  if (options.count && (isNaN(options.count) || options.count < 1 || options.count > 100)) {\n    throw new Error('-n must be a number between 1 and 100 inclusive');\n  }\n\n  // TODO(ville): handle the API result for not authenticated user instead of checking upfront\n  const user = await UserManager.ensureLoggedInAsync();\n  const { exp } = getConfig(projectDir, {\n    skipSDKVersionRequirement: true,\n  });\n\n  let result: any;\n  if (process.env.EXPO_LEGACY_API === 'true') {\n    // TODO(ville): move request from multipart/form-data to JSON once supported by the endpoint.\n    let formData = new FormData();\n    formData.append('queryType', 'history');\n    if (exp.owner) {\n      formData.append('owner', exp.owner);\n    }\n    formData.append('slug', await Project.getSlugAsync(projectDir));\n    formData.append('version', VERSION);\n    if (options.releaseChannel) {\n      formData.append('releaseChannel', options.releaseChannel);\n    }\n    if (options.count) {\n      formData.append('count', options.count);\n    }\n    if (options.platform) {\n      formData.append('platform', options.platform);\n    }\n    if (options.sdkVersion) {\n      formData.append('sdkVersion', options.sdkVersion);\n    }\n\n    result = await Api.callMethodAsync('publishInfo', [], 'post', null, {\n      formData,\n    });\n  } else {\n    const api = ApiV2.clientForUser(user);\n    result = await api.postAsync('publish/history', {\n      owner: exp.owner,\n      slug: await Project.getSlugAsync(projectDir),\n      version: VERSION,\n      releaseChannel: options.releaseChannel,\n      count: options.count,\n      platform: options.platform,\n      sdkVersion: options.sdkVersion,\n    });\n  }\n  return result;\n}\n\nexport async function setPublishToChannelAsync(\n  projectDir: string,\n  options: SetOptions\n): Promise<any> {\n  const user = await UserManager.ensureLoggedInAsync();\n  const api = ApiV2.clientForUser(user);\n  return await api.postAsync('publish/set', {\n    releaseChannel: options.releaseChannel,\n    publishId: options.publishId,\n    slug: await Project.getSlugAsync(projectDir),\n  });\n}\n\nasync function _rollbackPublicationFromChannelForPlatformAsync(\n  projectDir: string,\n  platform: 'android' | 'ios',\n  options: Omit<RollbackOptions, 'platform'>\n) {\n  const { releaseChannel, sdkVersion } = options;\n  // get the 2 most recent things in the channel history\n  const historyQueryResult = await getPublishHistoryAsync(projectDir, {\n    releaseChannel,\n    platform,\n    sdkVersion,\n    count: 2,\n  });\n\n  const history = historyQueryResult.queryResult as Publication[];\n  if (history.length === 0) {\n    throw new Error(\n      `There isn't anything published for release channel: ${releaseChannel}, sdk version: ${sdkVersion}, platform: ${platform}`\n    );\n  } else if (history.length === 1) {\n    throw new Error(\n      `There is only 1 publication for release channel: ${releaseChannel}, sdk version: ${sdkVersion}, platform: ${platform}. There won't be anything for users to receive if we rollback.`\n    );\n  }\n\n  // The second most recent publication in the history\n  const secondMostRecent = history[history.length - 1];\n\n  const nonInteractiveOptions = options.parent ? { parent: options.parent } : {};\n  // confirm that users will be receiving the secondMostRecent item in the Publish history\n  await _printAndConfirm(\n    projectDir,\n    secondMostRecent.publicationId,\n    releaseChannel,\n    platform,\n    nonInteractiveOptions\n  );\n\n  // apply the revert publication to channel\n  const revertProgress = ora(\n    `${platform}: Applying a revert publication to channel ${releaseChannel}`\n  ).start();\n  await setPublishToChannelAsync(projectDir, {\n    releaseChannel,\n    publishId: secondMostRecent.publicationId,\n  });\n  revertProgress.succeed(\n    `${platform}: Successfully applied revert publication. You can view it with \\`publish:history\\``\n  );\n}\n\nexport async function rollbackPublicationFromChannelAsync(\n  projectDir: string,\n  options: RollbackOptions\n) {\n  const { platform, ...restOfTheOptions } = options;\n\n  if (platform) {\n    return await _rollbackPublicationFromChannelForPlatformAsync(\n      projectDir,\n      platform,\n      restOfTheOptions\n    );\n  }\n\n  const platforms = ['android', 'ios'] as ('android' | 'ios')[];\n  const completedPlatforms = [] as ('android' | 'ios')[];\n  try {\n    for (const platform of platforms) {\n      await _rollbackPublicationFromChannelForPlatformAsync(projectDir, platform, restOfTheOptions);\n      completedPlatforms.push(platform);\n    }\n  } catch (e) {\n    if (completedPlatforms.length > 0) {\n      log.error(\n        `The platforms ${platforms.filter(\n          platform => !completedPlatforms.includes(platform)\n        )} have not been rolled back. You can complete the missing platforms by running \\`expo publish:rollback\\` with the --platform flag`\n      );\n    }\n    throw e;\n  }\n}\n\nasync function _printAndConfirm(\n  projectDir: string,\n  publicationId: string,\n  channel: string,\n  platform: string,\n  partialOptions: { parent?: { nonInteractive?: boolean } }\n): Promise<void> {\n  const detailOptions = {\n    publishId: publicationId,\n  };\n  const detail = await getPublicationDetailAsync(projectDir, detailOptions);\n  await printPublicationDetailAsync(detail, detailOptions);\n\n  if (partialOptions.parent && partialOptions.parent.nonInteractive) {\n    return;\n  }\n  const { confirm } = await prompt([\n    {\n      type: 'confirm',\n      name: 'confirm',\n      message: `${platform}: Users on the '${channel}' channel will receive the above publication as a result of the rollback.`,\n    },\n  ]);\n\n  if (!confirm) {\n    throw new Error(`You can run 'publish:set' to send the desired publication to users`);\n  }\n}\n\nexport async function getPublicationDetailAsync(\n  projectDir: string,\n  options: DetailOptions\n): Promise<PublicationDetail> {\n  // TODO(ville): handle the API result for not authenticated user instead of checking upfront\n  const user = await UserManager.ensureLoggedInAsync();\n  const { exp } = getConfig(projectDir, {\n    skipSDKVersionRequirement: true,\n  });\n  const slug = await Project.getSlugAsync(projectDir);\n  let result: any;\n  if (process.env.EXPO_LEGACY_API === 'true') {\n    let formData = new FormData();\n    formData.append('queryType', 'details');\n\n    if (exp.owner) {\n      formData.append('owner', exp.owner);\n    }\n    formData.append('publishId', options.publishId);\n    formData.append('slug', slug);\n\n    result = await Api.callMethodAsync('publishInfo', null, 'post', null, {\n      formData,\n    });\n  } else {\n    const api = ApiV2.clientForUser(user);\n    result = await api.postAsync('publish/details', {\n      owner: exp.owner,\n      publishId: options.publishId,\n      slug,\n    });\n  }\n\n  if (!result.queryResult) {\n    throw new Error('No records found matching your query.');\n  }\n\n  return result.queryResult;\n}\n\nexport async function printPublicationDetailAsync(\n  detail: PublicationDetail,\n  options: DetailOptions\n) {\n  if (options.raw) {\n    console.log(JSON.stringify(detail));\n    return;\n  }\n\n  let manifest = detail.manifest;\n  delete detail.manifest;\n\n  // Print general release info\n  let generalTableString = table.printTableJson(detail, 'Release Description');\n  console.log(generalTableString);\n\n  // Print manifest info\n  let manifestTableString = table.printTableJson(manifest, 'Manifest Details');\n  console.log(manifestTableString);\n}\n"],"file":"PublishUtils.js"}